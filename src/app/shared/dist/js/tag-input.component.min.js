"use strict";var __decorate=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(i<3?r(s):3<i?r(e,n,s):r(e,n))||s);return 3<i&&s&&Object.defineProperty(e,n,s),s};exports.__esModule=!0,exports.TagInputComponent=void 0;var core_1=require("@angular/core"),forms_1=require("@angular/forms"),TagInputComponent=function(){function t(){this.stringTag=new forms_1.FormControl("",[forms_1.Validators.required]),this.regexOptions=new Array,this.travelOption=!1,this.tags=new Array,this.optionalTags=new Array,this.tagsChange=new core_1.EventEmitter}return t.prototype.ngOnInit=function(){var n=this;this.stringTag.valueChanges.subscribe(function(e){if(","===e.substring(e.length-1)){var t=e.replace(",","").toLowerCase().trim();if(n.checkDuplication(t)||""===t||t.includes(","))return void n.stringTag.setValue(t);if(0<n.optionalTags.length&&!n.optionalTags.includes(t))return void n.stringTag.setValue(t);n.tags.push(t),n.stringTag.reset(""),n.tagsChange.emit(n.tags)}n.stringTag.valid?n.regexOptions=n.optionalTags.filter(function(t){return new RegExp(e,"i").test(t)&&!n.checkDuplication(t)}):n.regexOptions=new Array})},t.prototype.optionClick=function(t){this.stringTag.reset(""),this.tags.push(t),this.regexOptions=new Array,this.tagsChange.emit(this.tags),this.tagInput.nativeElement.focus()},t.prototype.checkDuplication=function(t){return-1<this.tags.indexOf(t)},t.prototype.checkBackspaceOnEmpty=function(t){var e,n=t.key;0<this.tags.length&&("Enter"===n||"Backspace"===n)&&!this.stringTag.valid&&(e=this.tags.pop(),this.stringTag.setValue(e+" "),this.tagsChange.emit(this.tags))},t.prototype.blurTag=function(){var t=this;this.travelOption||setTimeout(function(){t.regexOptions=new Array},200)},t.prototype.removeTag=function(t){this.tags.splice(t,1),this.tagsChange.emit(this.tags)},t.prototype.optionsFocus=function(t){var e=t.firstChild;0<this.regexOptions.length&&(this.travelOption=!0,e.focus())},t.prototype.nextFocus=function(t,e){var n=t.target,o=t.key;"ArrowDown"===o&&e!==this.regexOptions.length-1?n.nextSibling.focus():"ArrowUp"===o&&0!==e?n.previousSibling.focus():"ArrowUp"===o&&0===e?this.tagInput.nativeElement.focus():"Escape"===o&&(this.regexOptions=new Array)},t.prototype.exists=function(e){return!!this.optionalTags.length&&!this.optionalTags.some(function(t){return t===e})},__decorate([core_1.Input()],t.prototype,"tags"),__decorate([core_1.Input()],t.prototype,"optionalTags"),__decorate([core_1.Output()],t.prototype,"tagsChange"),__decorate([core_1.ViewChild("tagInput")],t.prototype,"tagInput"),t=__decorate([core_1.Component({selector:"tag-input",templateUrl:"./tag-input.component.html",styleUrls:["./tag-input.component.scss"]})],t)}();exports.TagInputComponent=TagInputComponent;