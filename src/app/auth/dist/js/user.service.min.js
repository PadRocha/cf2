"use strict";var __extends=this&&this.__extends||function(){var n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}(),__decorate=this&&this.__decorate||function(e,r,t,n){var o,i=arguments.length,u=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(u=(i<3?o(u):3<i?o(r,t,u):o(r,t))||u);return 3<i&&u&&Object.defineProperty(r,t,u),u},__param=this&&this.__param||function(t,n){return function(e,r){n(e,r,t)}};exports.__esModule=!0,exports.UserService=void 0;var core_1=require("@angular/core"),services_1=require("@auth/services"),rxjs_1=require("rxjs"),operators_1=require("rxjs/operators"),UserService=function(i){function e(e,r,e,t,e,n){var o=i.call(this,r,t,n)||this;return o.override=e,o.override=e,o.override=e,o.data$=o.http.get(o.url+"/user"),o.userChange$=new rxjs_1.BehaviorSubject({identifier:null,nickname:null,roles:new Array}),o.loggedIn&&o.update(),o}return __extends(e,i),e.prototype.update=function(){var r=this;this.data$.subscribe({next:function(e){r.userChange$.next(e)},error:this.destroy})},e.prototype.destroy=function(){this.userChange$.next({identifier:null,nickname:null,roles:new Array})},Object.defineProperty(e.prototype,"userSync",{get:function(){var r=this;return this.userChange$.asObservable().pipe(operators_1.skipWhile(function(e){return!e.identifier&&r.loggedIn}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logged",{get:function(){return!!this.userChange$.getValue().identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getId",{get:function(){return this.userChange$.getValue().identifier},enumerable:!1,configurable:!0}),e.prototype.isEqualTo=function(e){return this.userChange$.getValue().identifier===e},Object.defineProperty(e.prototype,"getNickname",{get:function(){return this.userChange$.getValue().nickname},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getRoles",{get:function(){return this.userChange$.getValue().roles},enumerable:!1,configurable:!0}),e.prototype.hasRole=function(e){var r=this.userChange$.getValue().roles;return Array.isArray(e)?e.some(function(e){return r.includes(e)}):r.includes(e)},e=__decorate([core_1.Injectable({providedIn:"root"}),__param(4,core_1.Inject(core_1.PLATFORM_ID))],e)}(services_1.AuthService);exports.UserService=UserService;